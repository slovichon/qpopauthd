for the temp file, use fdopen() and use the std lib for I/O
